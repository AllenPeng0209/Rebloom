# 心理咨詢師對話風格整合指南

## 🎯 問題分析

**之前的問題：**
- AI 回應太長，像在"講課"
- 一次性給太多建議，缺乏引導
- 缺乏真實心理咨詢師的對話技巧
- 用戶感覺被"教育"而非被"理解"

**解決方案：**
- 採用專業心理咨詢師的對話技巧
- 簡化回應長度（1-2句為主）
- 以傾聽和引導為核心
- 讓用戶多說，AI 少說

## 🏗️ 技術實現架構

### 1. 咨詢師技巧庫 (`src/utils/counselorTechniques.ts`)

**核心技巧分類：**
```typescript
interface CounselorResponse {
  type: 'reflection' | 'open_question' | 'clarification' | 'exploration' | 'summary' | 'validation';
  template: string;
  example: string;
  whenToUse: string;
}
```

**技巧示例：**
- **情感反映**：「聽起來你感到{emotion}...」
- **開放提問**：「你能多說說{topic}嗎？」
- **澄清理解**：「我想確認一下，你的意思是...？」
- **溫和探索**：「什麼讓你有這種感覺？」
- **驗證回應**：「有這種感覺是很正常的。」

### 2. 智能技巧選擇算法

**選擇邏輯：**
```typescript
const selectCounselorTechnique = (userInput: string, context: ConversationContext) => {
  // 強烈情緒 → 情感反映
  if (hasStrongEmotion(userInput)) return 'reflection';
  
  // 具體情況 → 澄清探索  
  if (hasSpecificSituation(userInput)) return 'exploration';
  
  // 對話初期 → 開放提問
  if (context.sessionLength < 3) return 'open_question';
  
  // 默認 → 情感反映
  return 'reflection';
}
```

### 3. 增強提示詞系統

**新增指導原則：**
```
心理咨詢師對話技巧：
【核心原則】
- 以傾聽為主，說話為輔
- 用開放式問題引導探索
- 避免直接給建議，而是引導用戶自己發現
- 每次回應控制在1-2句話，簡潔有力
- 多用反映、澄清、總結技巧

【回應模式】
1. 情感反映："聽起來你感到..."
2. 開放提問："你能多說說...嗎？"
3. 澄清理解："我想確認一下，你的意思是..."
4. 溫和探索："什麼讓你有這種感覺？"
5. 適度總結："如果我理解正確的話..."

【避免的回應】
❌ 長篇大論的建議
❌ 連續多個問題
❌ 急於解決問題
❌ 說教式的回應
❌ 過度積極的鼓勵
```

## 🎭 對話風格對比

### 傳統 AI 風格（問題）
```
用戶：我最近工作壓力很大，經常失眠。

AI：我理解你現在面臨的工作壓力問題。失眠是壓力的常見表現，建議你可以嘗試以下方法：
1. 建立規律的睡前習慣
2. 練習深呼吸放鬆技巧  
3. 避免睡前使用電子設備
4. 可以嘗試冥想或漸進式肌肉放鬆
5. 如果情況持續，建議尋求專業協助
同時，你也可以考慮調整工作節奏，學習時間管理技巧...
```
**問題：太長、太多建議、像在上課**

### 新的咨詢師風格（解決方案）
```
用戶：我最近工作壓力很大，經常失眠。

AI：聽起來你感到很疲憊。你能多說說這種壓力嗎？

用戶：就是工作任務太多，老闆要求很嚴格，我總是擔心做不好。

AI：我想確認一下，你最擔心的是什麼？

用戶：擔心被老闆批評，擔心失去工作。

AI：這種擔心對你來說一定很沉重。什麼時候你會特別有這種感覺？
```
**改善：簡短、引導式、讓用戶多表達**

## 🔧 實現細節

### 1. 動態技巧選擇

**情緒檢測：**
```typescript
const emotionMapping = {
  '累': '疲憊',
  '煩': '煩躁', 
  '焦慮': '焦慮',
  '壓力': '有壓力'
};

const detectEmotion = (input: string) => {
  for (const [keyword, emotion] of Object.entries(emotionMapping)) {
    if (input.includes(keyword)) return emotion;
  }
};
```

**話題提取：**
```typescript
const extractKeyTopic = (input: string) => {
  const topics = ['工作', '家庭', '朋友', '學習', '健康'];
  return topics.find(topic => input.includes(topic));
};
```

### 2. 上下文感知回應

**會話階段適配：**
- **初期** (1-3輪)：多用開放式提問，建立安全感
- **中期** (4-8輪)：深入探索，使用反映和澄清
- **後期** (9+輪)：總結理解，適度驗證

**情緒狀態適配：**
- **高情緒**：優先使用情感反映
- **困惑狀態**：使用澄清和探索
- **穩定狀態**：使用開放式提問

### 3. 記憶整合

**個性化引導：**
```typescript
// 基於歷史記憶的回應
if (relevantMemories.length > 0) {
  response += ` 我記得你之前提到過類似的感受。`;
}
```

**模式識別：**
- 識別重複出現的話題
- 記住用戶的表達偏好
- 適應用戶的開放程度

## 📊 效果測試案例

### 案例 1：工作壓力
```
用戶：我覺得我快撐不住了，工作太累了。

舊版AI：我理解你的工作壓力很大。建議你可以嘗試以下放鬆方法：深呼吸、運動、調整作息...

新版AI：聽起來你感到很疲憊。你能多說說"撐不住"是什麼感覺嗎？
```

### 案例 2：人際關係
```
用戶：我和朋友吵架了，不知道該怎麼辦。

舊版AI：人際關係中出現衝突是正常的。你可以嘗試：1.冷靜分析問題原因 2.主動溝通表達想法 3.學會換位思考...

新版AI：這對你來說一定很難受。什麼讓你們產生了分歧？
```

### 案例 3：情緒困擾
```
用戶：我最近心情很低落，什麼都不想做。

舊版AI：情緒低落可能是多種原因造成的。建議你：保持規律作息、適度運動、尋找興趣愛好、必要時尋求專業協助...

新版AI：我能感受到你的沮喪。你想從哪裡開始說起？
```

## 🎯 核心改進要點

### 1. 回應長度控制
- **目標**：1-2句話為主
- **最多**：不超過3句話
- **重點**：引發思考而非提供答案

### 2. 對話主導權
- **用戶主導**：讓用戶決定談論內容
- **AI 引導**：通過提問引導深入探索
- **避免**：AI 主導話題方向

### 3. 情感連接
- **反映情感**：「聽起來你感到...」
- **驗證體驗**：「這很正常」、「你很勇敢」
- **陪伴感**：「我在這裡陪伴你」

### 4. 專業邊界
- **不診斷**：避免給出診斷性語言
- **不處方**：不提供具體藥物建議
- **轉介**：適時建議尋求專業協助

## 🚀 使用指南

### 開發者使用
1. **導入技巧庫**：使用預定義的咨詢師技巧
2. **配置參數**：根據用戶設定調整回應風格
3. **監控效果**：觀察對話流暢度和用戶參與度

### 用戶體驗
1. **更自然**：感覺像與真人咨詢師對話
2. **更安全**：不會被過度"指導"
3. **更深入**：通過引導自己發現解決方案
4. **更個性化**：基於記憶的個性化理解

## 📈 預期效果

### 對話質量提升
- **參與度**：用戶更願意深入表達
- **持續性**：對話更能持續進行
- **滿意度**：用戶感受到被理解而非被教育

### 治療效果增強
- **自我覺察**：通過引導促進自我反思
- **主動性**：用戶更主動探索問題
- **成長感**：感受到自己的發現和成長

這個改進讓 AI 從"知識型助手"轉變為"陪伴型咨詢師"，真正實現了專業心理咨詢的對話風格！
