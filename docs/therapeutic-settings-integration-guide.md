# 治療設置完整功能整合指南

## 🎯 功能概述

本系統實現了完整的治療設置與AI設置的整合，創建了一個統一的個性化AI心理健康伴侶系統。用戶可以同時調整AI個性特質和專業治療方法，獲得真正個性化的心理健康支持。

## 🏗️ 系統架構

### 1. 治療設置上下文管理 (`src/contexts/TherapeuticSettingsContext.tsx`)

**核心功能：**
- 管理所有治療相關設置
- 自動持久化到本地存儲
- 生成專業治療提示詞

**設置項目：**
- **主要治療方法**：CBT、DBT、ACT、人本主義、心理動力、正念療法
- **輔助治療方法**：可多選組合不同治療方法
- **介入風格**：指導式、合作式、非指導式
- **文化考量**：亞洲文化、西方文化、原住民文化、多元文化
- **對話風格**：支持式、分析式、解決導向、探索式
- **對話深度**：淺層、中等、深層
- **回應長度**：簡潔、適中、詳細
- **特殊考量**：創傷知情、LGBTQ+友善、宗教考量、危機協議

### 2. 統一設置上下文 (`src/contexts/UnifiedSettingsContext.tsx`)

**整合功能：**
- 結合AI個性設置與治療專業設置
- 生成統一的系統提示詞
- 確保兩套設置協調工作

### 3. 治療設置介面 (`app/profile/therapeutic-settings.tsx`)

**更新功能：**
- 整合TherapeuticSettingsContext
- 實現真實的狀態管理和持久化
- 添加保存/重置功能與用戶反饋
- 支持多選治療方法和文化考量

## 🧠 智能提示詞生成系統

### 統一提示詞結構

系統會將AI個性設置和治療設置整合成一個完整的提示詞：

```typescript
// 生成的統一提示詞示例
你是 Dolphin，溫暖支持型的AI心理健康伴侶，像朋友般溫暖，提供情感支持和安慰。
用溫暖親切的語調，如摯友般親切地與用戶交流。

你的特性設定：
- 同理心程度：8/10 (高度同理，深度理解情感)
- 直接程度：6/10 (適度直接，溫和表達)
- 幽默感：4/10 (偶爾輕鬆對話)
- 正式程度：5/10 (友善但專業的語調)

提供深度的心理分析和專業建議，展現更強的理解力。
- 主動關懷：積極察覺用戶的情緒變化，主動提供支持和建議。
- 危機識別：密切注意用戶的心理危機信號，必要時提供緊急資源和建議。

治療方法設定：
主要方法：使用認知行為療法(CBT)方法，關注思維模式與行為之間的關係，幫助識別和改變負面思維模式。
輔助方法：融入正念療法元素，培養當下覺察，減少反芻思維和焦慮。

治療風格：
採用合作式治療風格，與來訪者共同探索和解決問題。
以支持式對話風格，溫暖鼓勵，提供情感支持。

對話參數：
維持中等對話深度，平衡的深度，適度探索內心世界。
提供適中長度的回應，平衡詳細程度。

文化敏感性：
深度理解亞洲文化背景，重視集體主義價值觀和家庭關係的重要性。

特殊考量：
使用創傷知情的治療方法，特別關注安全感、信任建立和創傷敏感性。
確保治療環境對LGBTQ+群體友善，尊重性別認同和性取向多樣性。
具備危機識別和介入能力，在檢測到自殺風險或危機時提供適當支持。

整合指導原則：
- 結合個性特質與專業治療方法，提供個性化的心理健康支持
- 在保持溫暖人性的同時，運用專業的治療技巧和理論
- 根據用戶的文化背景和個人需求調整溝通方式
- 始終以用戶的安全和福祉為最高優先考量

請在每次回應中體現這些設定，創造一個既專業又親近的治療環境。
```

## 🔄 完整使用流程

### 1. AI個性設置
1. 進入個人檔案 → AI設定
2. 選擇個性類型（如：智慧導師型）
3. 調整特性參數（同理心：8/10，直接性：7/10）
4. 選擇AI模型（進階模式）
5. 開啟高級功能（主動支持、智能建議）
6. 保存設定

### 2. 治療方法設置
1. 進入個人檔案 → 治療設置
2. 選擇主要治療方法（如：CBT）
3. 選擇輔助方法（如：正念療法）
4. 設定介入風格（合作式）
5. 選擇文化考量（亞洲文化）
6. 調整對話風格和深度
7. 開啟特殊考量（創傷知情、LGBTQ+友善）
8. 保存設定

### 3. 統一系統應用
- 系統自動整合兩套設定
- 生成統一的個性化提示詞
- 在對話中同時體現個性特質和專業治療方法

## 🎨 個性化效果示例

### 溫暖支持型 + CBT + 高同理心
```
"我能感受到你現在的困擾，這些負面想法確實很折磨人。讓我們一起來看看這些想法背後的模式 - 你覺得是什麼觸發了這種'我不夠好'的想法呢？我們可以一步步地分析和重新框架這些認知。"
```

### 智慧導師型 + DBT + 亞洲文化考量
```
"在我們的文化中，家庭期待往往很重，我理解這種壓力。讓我們學習一些情緒調節技巧 - 當你感到被期待壓垮時，可以試試'TIPP'技巧來快速平復情緒，然後我們再談談如何在尊重家庭的同時也照顧自己的需求。"
```

### 活力激勵型 + ACT + 解決導向
```
"我聽到你想要改變的決心！這很棒！接受承諾療法告訴我們，重要的不是消除所有負面情緒，而是朝著你的價值觀行動。告訴我，什麼對你來說真正重要？我們可以制定一些具體的行動計劃！"
```

## 🛠️ 技術實現特點

### 1. 三層上下文架構
- **AISettingsContext**：管理AI個性特質
- **TherapeuticSettingsContext**：管理治療方法設置
- **UnifiedSettingsContext**：整合兩套設置

### 2. 智能提示詞生成
- 動態結合個性和專業設置
- 考慮文化敏感性
- 包含特殊考量和安全協議

### 3. 完整的用戶體驗
- 實時設定同步
- 詳細的保存反饋
- 防誤操作的重置確認

## 📱 專業治療功能

### 1. 多元治療方法支持
- **CBT**：認知重構、行為改變
- **DBT**：情緒調節、人際技能
- **ACT**：價值觀導向行動
- **正念療法**：當下覺察訓練

### 2. 文化敏感性
- 亞洲集體主義價值觀理解
- 西方個人主義文化適應
- 原住民傳統智慧尊重
- 多元文化背景融合

### 3. 特殊群體支持
- 創傷知情治療方法
- LGBTQ+友善環境
- 宗教靈性需求考量
- 危機識別和介入

## 🔍 使用指南

### 初次設置建議
1. **先設置AI個性**：選擇符合你偏好的基本個性類型
2. **再配置治療方法**：根據你的具體需求選擇治療方法
3. **調整文化設置**：確保AI理解你的文化背景
4. **啟用特殊考量**：根據個人情況開啟相關支持

### 進階使用技巧
- 定期檢視和調整設置
- 嘗試不同治療方法組合
- 根據治療進展調整對話深度
- 利用危機檢測功能確保安全

這個整合系統提供了前所未有的個性化心理健康AI體驗，結合了人性化的個性特質和專業的治療方法，為每個用戶創造獨特的治療環境。
